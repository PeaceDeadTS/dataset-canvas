# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ Markdown.

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. XSS —á–µ—Ä–µ–∑ JavaScript (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<script>alert('XSS')</script>`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è `rehype-sanitize`  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –¢–µ–≥ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ –≤—ã–≤–æ–¥–∞

### 2. XSS —á–µ—Ä–µ–∑ `onerror` (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<img src="x" onerror="alert('XSS')">`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –ê—Ç—Ä–∏–±—É—Ç—ã —Å–æ–±—ã—Ç–∏–π —É–¥–∞–ª—è—é—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –†–µ–Ω–¥–µ—Ä–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ `<img src="x">` –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### 3. XSS —á–µ—Ä–µ–∑ `onclick` (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<a href="#" onclick="alert('XSS')">Click me</a>`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π —É–¥–∞–ª—è—é—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –°—Å—ã–ª–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –±–µ–∑ JavaScript

### 4. Data URLs —Å JavaScript (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<a href="javascript:alert('XSS')">Click</a>`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ JavaScript URLs –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –°—Å—ã–ª–∫–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏–ª–∏ –∑–∞–º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω—É—é

### 5. Iframe injection (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<iframe src="https://evil.com"></iframe>`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ iframe –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª—è–µ—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –¢–µ–≥ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è

### 6. Object/Embed tags (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<object data="https://evil.com"></object>`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –û–ø–∞—Å–Ω—ã–µ —Ç–µ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

### 7. Style injection (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<style>body { display: none; }</style>`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ Style —Ç–µ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –°—Ç–∏–ª–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

### 8. SVG —Å JavaScript (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<svg><script>alert('XSS')</script></svg>`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ Script –≤–Ω—É—Ç—Ä–∏ SVG —É–¥–∞–ª—è–µ—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** SVG —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –±–µ–∑ —Å–∫—Ä–∏–ø—Ç–æ–≤

### 9. HTML entity bypass (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `&lt;script&gt;alert('XSS')&lt;/script&gt;`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ —Ç–µ–∫—Å—Ç  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –≠–∫—Ä–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

### 10. Meta tag injection (–ë–ï–ó–û–ü–ê–°–ù–û)

**–¢–µ—Å—Ç:** `<meta http-equiv="refresh" content="0;url=https://evil.com">`  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ Meta —Ç–µ–≥–∏ —É–¥–∞–ª—è—é—Ç—Å—è  
**–ü–æ–≤–µ–¥–µ–Ω–∏–µ:** –¢–µ–≥ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è

## üõ°Ô∏è –ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã

### rehype-sanitize

–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `rehype-sanitize` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ–ø–∞—Å–Ω–æ–≥–æ HTML:

```typescript
import rehypeSanitize from 'rehype-sanitize';

<ReactMarkdown
  remarkPlugins={[remarkGfm]}
  rehypePlugins={[rehypeSanitize]}  // ‚Üê –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è HTML
>
  {content}
</ReactMarkdown>
```

**–ß—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è:**
- –í—Å–µ `<script>` —Ç–µ–≥–∏
- –ê—Ç—Ä–∏–±—É—Ç—ã-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π (`onclick`, `onerror`, `onload`, etc.)
- JavaScript URLs (`javascript:`, `data:text/html`)
- –û–ø–∞—Å–Ω—ã–µ —Ç–µ–≥–∏ (`iframe`, `object`, `embed`, `form`)
- Style —Ç–µ–≥–∏ –∏ –∞—Ç—Ä–∏–±—É—Ç—ã
- Meta –∏ base —Ç–µ–≥–∏

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ä—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ `rel="noopener noreferrer"`**
   - –í—Å–µ –≤–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è —Å –∑–∞—â–∏—Ç–æ–π –æ—Ç tabnabbing
   
2. **–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π `target="_blank"`**
   - –í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ –Ω–æ–≤–æ–π –≤–∫–ª–∞–¥–∫–µ

3. **Content Security Policy (CSP)**
   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å CSP headers –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ```
   Content-Security-Policy: 
     default-src 'self';
     img-src 'self' https:;
     style-src 'self' 'unsafe-inline';
   ```

## üìù –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ Markdown

### –†–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ —Ç–µ–≥–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–∏:

‚úÖ **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞**
- `**–∂–∏—Ä–Ω—ã–π**` ‚Üí **–∂–∏—Ä–Ω—ã–π**
- `*–∫—É—Ä—Å–∏–≤*` ‚Üí *–∫—É—Ä—Å–∏–≤*
- `~~–∑–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π~~` ‚Üí ~~–∑–∞—á–µ—Ä–∫–Ω—É—Ç—ã–π~~

‚úÖ **–°—Å—ã–ª–∫–∏**
- `[—Ç–µ–∫—Å—Ç](https://example.com)` ‚Üí –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Å—Å—ã–ª–∫–∏ —Å `rel="noopener noreferrer"`

‚úÖ **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è**
- `![alt](https://example.com/image.png)` ‚Üí –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å lazy loading
- –ö–ª–∏–∫ –ø–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—é –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ

‚úÖ **–ë–ª–æ–∫–∏ –∫–æ–¥–∞**
```
`inline code`
```

````
```language
code block
```
````

‚úÖ **–°–ø–∏—Å–∫–∏**
- –ú–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏
- –ù—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏

‚úÖ **–¶–∏—Ç–∞—Ç—ã**
> Blockquote —Ç–µ–∫—Å—Ç

‚úÖ **–¢–∞–±–ª–∏—Ü—ã (GFM)**
| Header | Header |
|--------|--------|
| Cell   | Cell   |

‚úÖ **–ó–∞–≥–æ–ª–æ–≤–∫–∏**
# H1
## H2
### H3

## üîç –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### 1. –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –≤—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ XSS payload –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –æ–ø–∞—Å–Ω–æ–≥–æ HTML –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞–º–∏ (Chrome, Firefox, Safari, Edge)

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–°–æ–∑–¥–∞—Ç—å unit-—Ç–µ—Å—Ç—ã –¥–ª—è MarkdownRenderer:

```typescript
describe('MarkdownRenderer Security', () => {
  it('should remove script tags', () => {
    const malicious = '<script>alert("XSS")</script>';
    // render and check that script is removed
  });
  
  it('should remove event handlers', () => {
    const malicious = '<img src="x" onerror="alert(1)">';
    // check that onerror is stripped
  });
});
```

### 3. Penetration Testing
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ç–∏–ø–∞ OWASP ZAP
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å payload –∏–∑ OWASP XSS Filter Evasion Cheat Sheet
- –ü—Ä–æ–≤–µ—Å—Ç–∏ –∫–æ–¥-—Ä–µ–≤—å—é —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –í–´–°–û–ö–ò–ô**

–°–∏—Å—Ç–µ–º–∞ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ Markdown –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:
- ‚úÖ `react-markdown` - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ Markdown
- ‚úÖ `rehype-sanitize` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–ø–∞—Å–Ω–æ–≥–æ HTML
- ‚úÖ `remark-gfm` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Markdown –±–µ–∑ —Ä–∏—Å–∫–æ–≤

–í—Å–µ –±–∞–∑–æ–≤—ã–µ XSS –≤–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ HTML.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
1. –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (npm audit)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Content Security Policy –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. –ü—Ä–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π security audit –ø–µ—Ä–µ–¥ production
4. –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –≤ CI/CD
5. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å security advisory –¥–ª—è –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤

